[gd_scene load_steps=21 format=2]

[ext_resource path="res://ui/gui/button/small/small_button.tscn" type="PackedScene" id=1]
[ext_resource path="res://ui/gui/button/joystick/mobile_joystick.tscn" type="PackedScene" id=2]
[ext_resource path="res://ui/gui/icons/special_attack_icon.png" type="Texture" id=3]
[ext_resource path="res://system/components/callers/comp_method_caller.tscn" type="PackedScene" id=4]
[ext_resource path="res://ui/gui/button/joystick/shoot/joystick_button_shoot.png" type="Texture" id=5]
[ext_resource path="res://ui/platform_exclusive_feature.gd" type="Script" id=6]
[ext_resource path="res://ui/gui/icons/pause_icon.png" type="Texture" id=7]
[ext_resource path="res://system/components/callers/comp_event_caller.tscn" type="PackedScene" id=8]
[ext_resource path="res://system/components/receivers/comp_event_receiver.tscn" type="PackedScene" id=10]
[ext_resource path="res://ui/gui/text_box/text_box_horizontal.png" type="Texture" id=11]
[ext_resource path="res://ui/default_theme.tres" type="Theme" id=12]
[ext_resource path="res://ui/mobile_ui/tutorial_controller_mobile.gd" type="Script" id=13]
[ext_resource path="res://system/random_scripts/visibility_controller.gd" type="Script" id=14]
[ext_resource path="res://ui/gui/text_box/text_box_vertical.png" type="Texture" id=15]
[ext_resource path="res://ui/gui/button/small/button_small_pressed.png" type="Texture" id=16]
[ext_resource path="res://ui/gui/button/small/button_small_normal.png" type="Texture" id=17]
[ext_resource path="res://ui/gui/text_box/text_box_rectangle.png" type="Texture" id=18]
[ext_resource path="res://ui/mobile_ui/mobile_button_displacement.gd" type="Script" id=19]

[sub_resource type="Shader" id=3]
code = "shader_type canvas_item;

void fragment() {
	vec4 GRAY = vec4(0.25, 0.25, 0.25, 1.0);
	vec4 BLACK = vec4(0.0, 0.0, 0.0, 1.0);
	vec4 pixel_color = texture(SCREEN_TEXTURE, SCREEN_UV);
	vec4 final_color;
	
	if (pixel_color == vec4(1.0, 1.0, 1.0, 1.0)) {
		final_color = GRAY;
	} else {
		final_color = BLACK;
	}
	COLOR = final_color;
}"

[sub_resource type="ShaderMaterial" id=2]
shader = SubResource( 3 )

[node name="mobile_ui" type="Control"]
anchor_right = 1.0
anchor_bottom = 1.0
mouse_filter = 2
script = ExtResource( 6 )

[node name="tutorial_controller" type="Node" parent="."]
script = ExtResource( 13 )

[node name="movement_first_appear_timer" type="Timer" parent="tutorial_controller"]
one_shot = true

[node name="movement_timer" type="Timer" parent="tutorial_controller"]
wait_time = 1.6

[node name="hunger_timer" type="Timer" parent="tutorial_controller"]
wait_time = 3.6

[node name="shooting_joystick" type="HBoxContainer" parent="."]
anchor_left = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
margin_left = -45.0
grow_horizontal = 0
rect_pivot_offset = Vector2( -434, -7 )
custom_constants/separation = 0

[node name="shooting_joystick_vertical_container" type="VBoxContainer" parent="shooting_joystick"]
margin_bottom = 135.0
custom_constants/separation = 0
alignment = 2

[node name="shooting_joystick" parent="shooting_joystick/shooting_joystick_vertical_container" instance=ExtResource( 2 )]
margin_top = 110.0
margin_bottom = 110.0

[node name="TouchScreenButton" parent="shooting_joystick/shooting_joystick_vertical_container/shooting_joystick/background/button_pivot" index="0"]
normal = ExtResource( 5 )
input_event = "player_shooting_direction_updated"
read_touches = false

[node name="pressed_method_caller" parent="shooting_joystick/shooting_joystick_vertical_container/shooting_joystick" instance=ExtResource( 4 )]
method = {
"args": [ "player_shooting_joystick_pressed" ],
"caller": "input_events",
"method": "emit_signal"
}

[node name="released_method_caller" parent="shooting_joystick/shooting_joystick_vertical_container/shooting_joystick" instance=ExtResource( 4 )]
method = {
"args": [ "player_shooting_joystick_released" ],
"caller": "input_events",
"method": "emit_signal"
}

[node name="shooting_tutorial" type="TextureRect" parent="shooting_joystick/shooting_joystick_vertical_container/shooting_joystick" groups=["tutorial", "tutorial_shooting"]]
margin_left = -121.0
margin_top = -24.0
margin_right = -18.0
margin_bottom = 24.0
size_flags_horizontal = 0
texture = ExtResource( 11 )
flip_h = true
script = ExtResource( 14 )
visible_by_default = false

[node name="Label" type="Label" parent="shooting_joystick/shooting_joystick_vertical_container/shooting_joystick/shooting_tutorial"]
anchor_left = 0.038835
anchor_top = 0.0833333
anchor_right = 0.932039
anchor_bottom = 0.916667
size_flags_horizontal = 0
theme = ExtResource( 12 )
text = "tutorial.throw_stone"
align = 1
valign = 1
autowrap = true
__meta__ = {
"_edit_use_anchors_": true
}

[node name="special_attack_tutorial" type="TextureRect" parent="shooting_joystick/shooting_joystick_vertical_container/shooting_joystick" groups=["tutorial", "tutorial_special_attack"]]
margin_left = -121.0
margin_top = -24.0
margin_right = -18.0
margin_bottom = 24.0
size_flags_horizontal = 0
texture = ExtResource( 11 )
flip_h = true
script = ExtResource( 14 )
visible_by_default = false

[node name="Label" type="Label" parent="shooting_joystick/shooting_joystick_vertical_container/shooting_joystick/special_attack_tutorial"]
anchor_left = 0.038835
anchor_top = 0.0833333
anchor_right = 0.932039
anchor_bottom = 0.916667
size_flags_horizontal = 0
theme = ExtResource( 12 )
text = "tutorial.special_attack"
align = 1
valign = 1
autowrap = true
__meta__ = {
"_edit_use_anchors_": true
}

[node name="bottom_margin" type="MarginContainer" parent="shooting_joystick/shooting_joystick_vertical_container"]
margin_top = 110.0
margin_bottom = 135.0
custom_constants/margin_bottom = 25
script = ExtResource( 19 )
margin_axis = "-y"
assigned_setting_value = "shooting_joystick"

[node name="right_margin" type="MarginContainer" parent="shooting_joystick"]
margin_right = 45.0
margin_bottom = 135.0
custom_constants/margin_right = 45
script = ExtResource( 19 )
margin_axis = "-x"
assigned_setting_value = "shooting_joystick"

[node name="special_attack" type="HBoxContainer" parent="."]
anchor_left = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
margin_left = -27.0
grow_horizontal = 0
rect_pivot_offset = Vector2( -434, -7 )
custom_constants/separation = 0
alignment = 2

[node name="special_attack_vertical_container" type="VBoxContainer" parent="special_attack"]
margin_left = 13.0
margin_right = 13.0
margin_bottom = 135.0
custom_constants/separation = 0
alignment = 2

[node name="button_anchor" type="Control" parent="special_attack/special_attack_vertical_container"]
margin_top = 121.0
margin_bottom = 121.0
mouse_filter = 2

[node name="special_attack_button" type="TextureRect" parent="special_attack/special_attack_vertical_container/button_anchor"]
margin_left = -8.0
margin_top = -8.0
margin_right = 8.0
margin_bottom = 8.0
texture = ExtResource( 3 )

[node name="TouchScreenButton" type="TouchScreenButton" parent="special_attack/special_attack_vertical_container/button_anchor/special_attack_button"]
show_behind_parent = true
position = Vector2( -2, -2 )
normal = ExtResource( 17 )
pressed = ExtResource( 16 )

[node name="comp_method_caller" parent="special_attack/special_attack_vertical_container/button_anchor/special_attack_button/TouchScreenButton" instance=ExtResource( 4 )]
method = {
"args": [ "enter_eat_state_request" ],
"caller": "player_events",
"method": "emit_signal"
}

[node name="grayscale_overlay" type="ColorRect" parent="special_attack/special_attack_vertical_container/button_anchor/special_attack_button"]
visible = false
material = SubResource( 2 )
margin_left = -1.0
margin_top = -1.0
margin_right = 17.0
margin_bottom = 17.0
script = ExtResource( 14 )

[node name="set_grayscale_event" parent="special_attack/special_attack_vertical_container/button_anchor/special_attack_button/grayscale_overlay" instance=ExtResource( 10 )]
emitter = "player_events"
event = "special_attack_available"

[node name="set_normal_event" parent="special_attack/special_attack_vertical_container/button_anchor/special_attack_button/grayscale_overlay" instance=ExtResource( 10 )]
emitter = "player_events"
event = "special_attack_unavailable"

[node name="bottom_margin" type="MarginContainer" parent="special_attack/special_attack_vertical_container"]
margin_top = 121.0
margin_bottom = 135.0
custom_constants/margin_bottom = 14
script = ExtResource( 19 )
margin_axis = "-y"
assigned_setting_value = "special_attack"

[node name="right_margin" type="MarginContainer" parent="special_attack"]
margin_left = 13.0
margin_right = 27.0
margin_bottom = 135.0
custom_constants/margin_right = 14
script = ExtResource( 19 )
margin_axis = "-x"
assigned_setting_value = "special_attack"

[node name="movement_joystick" type="HBoxContainer" parent="."]
anchor_bottom = 1.0

[node name="left_margin" type="MarginContainer" parent="movement_joystick"]
margin_right = 35.0
margin_bottom = 135.0
custom_constants/margin_left = 35
script = ExtResource( 19 )
assigned_setting_value = "movement_joystick"

[node name="h_box_container" type="VBoxContainer" parent="movement_joystick"]
margin_left = 39.0
margin_right = 39.0
margin_bottom = 135.0
alignment = 2

[node name="movement_joystick" parent="movement_joystick/h_box_container" instance=ExtResource( 2 )]
margin_top = 111.0
margin_bottom = 111.0

[node name="movement_tutorial" type="TextureRect" parent="movement_joystick/h_box_container/movement_joystick" groups=["tutorial", "tutorial_movement"]]
visible = false
margin_left = 18.0
margin_top = -24.0
margin_right = 121.0
margin_bottom = 24.0
size_flags_horizontal = 0
texture = ExtResource( 11 )
script = ExtResource( 14 )
visible_by_default = false

[node name="Label" type="Label" parent="movement_joystick/h_box_container/movement_joystick/movement_tutorial"]
anchor_left = 0.0679612
anchor_top = 0.0833333
anchor_right = 0.961165
anchor_bottom = 0.916667
size_flags_horizontal = 0
theme = ExtResource( 12 )
text = "tutorial.movement"
align = 1
valign = 1
autowrap = true
__meta__ = {
"_edit_use_anchors_": true
}

[node name="comp_event_caller" parent="movement_joystick/h_box_container/movement_joystick" instance=ExtResource( 8 )]

[node name="comp_event_caller2" parent="movement_joystick/h_box_container/movement_joystick" instance=ExtResource( 8 )]

[node name="bottom_margin" type="MarginContainer" parent="movement_joystick/h_box_container"]
margin_top = 115.0
margin_bottom = 135.0
custom_constants/margin_bottom = 20
script = ExtResource( 19 )
margin_axis = "-y"
assigned_setting_value = "movement_joystick"

[node name="pause_button" type="HBoxContainer" parent="."]
anchor_left = 1.0
anchor_right = 1.0
margin_left = -40.0
margin_bottom = 40.0
grow_horizontal = 0
custom_constants/separation = 0
alignment = 2

[node name="HBoxContainer" type="VBoxContainer" parent="pause_button"]
margin_left = 28.0
margin_right = 28.0
margin_bottom = 40.0
custom_constants/separation = 0

[node name="top_margin" type="MarginContainer" parent="pause_button/HBoxContainer"]
margin_bottom = 12.0
custom_constants/margin_top = 12
script = ExtResource( 19 )
margin_axis = "y"
assigned_setting_value = "pause_button"

[node name="button_anchor" type="Control" parent="pause_button/HBoxContainer"]
margin_top = 12.0
margin_bottom = 12.0
mouse_filter = 2

[node name="pause_button" parent="pause_button/HBoxContainer/button_anchor" instance=ExtResource( 1 )]
margin_left = -10.0
margin_top = -10.0
margin_right = 10.0
margin_bottom = 10.0

[node name="icon" parent="pause_button/HBoxContainer/button_anchor/pause_button/center_container" index="0"]
margin_left = 2.0
margin_top = 2.0
margin_right = 18.0
margin_bottom = 18.0
texture = ExtResource( 7 )

[node name="comp_event_caller" parent="pause_button/HBoxContainer/button_anchor/pause_button" instance=ExtResource( 8 )]
event = "toggle_pause_request"

[node name="right_margin" type="MarginContainer" parent="pause_button"]
margin_left = 28.0
margin_right = 40.0
margin_bottom = 40.0
custom_constants/margin_right = 12
script = ExtResource( 19 )
margin_axis = "-x"
assigned_setting_value = "pause_button"

[node name="hunger_tutorial_container" type="VBoxContainer" parent="."]
margin_right = 40.0
margin_bottom = 40.0
custom_constants/separation = 0

[node name="MarginContainer" type="MarginContainer" parent="hunger_tutorial_container"]
margin_right = 120.0
margin_bottom = 17.0
custom_constants/margin_top = 17

[node name="HBoxContainer" type="HBoxContainer" parent="hunger_tutorial_container"]
margin_top = 17.0
margin_right = 120.0
margin_bottom = 68.0
custom_constants/separation = 0

[node name="MarginContainer2" type="MarginContainer" parent="hunger_tutorial_container/HBoxContainer"]
margin_right = 20.0
margin_bottom = 51.0
custom_constants/margin_left = 20

[node name="hunger_tutorial" type="TextureRect" parent="hunger_tutorial_container/HBoxContainer" groups=["tutorial", "tutorial_hunger"]]
margin_left = 20.0
margin_right = 120.0
margin_bottom = 51.0
size_flags_horizontal = 0
texture = ExtResource( 15 )
flip_v = true
script = ExtResource( 14 )
visible_by_default = false

[node name="Label" type="Label" parent="hunger_tutorial_container/HBoxContainer/hunger_tutorial"]
anchor_left = 0.04
anchor_top = 0.137255
anchor_right = 0.96
anchor_bottom = 0.921569
size_flags_horizontal = 0
theme = ExtResource( 12 )
text = "tutorial.hunger"
align = 1
valign = 1
autowrap = true
__meta__ = {
"_edit_use_anchors_": true
}

[node name="HBoxContainer" type="HBoxContainer" parent="."]
anchor_right = 1.0
anchor_bottom = 1.0
mouse_filter = 2
alignment = 1
__meta__ = {
"_edit_lock_": true
}

[node name="VBoxContainer" type="VBoxContainer" parent="HBoxContainer"]
margin_left = 70.0
margin_right = 170.0
margin_bottom = 135.0
rect_pivot_offset = Vector2( -113, 13 )
custom_constants/separation = 0
alignment = 2

[node name="pick_stone_tutorial" type="TextureRect" parent="HBoxContainer/VBoxContainer" groups=["tutorial", "tutorial_pick_stone"]]
margin_top = 85.0
margin_right = 100.0
margin_bottom = 133.0
size_flags_horizontal = 0
texture = ExtResource( 18 )
flip_h = true
script = ExtResource( 14 )
visible_by_default = false

[node name="Label" type="Label" parent="HBoxContainer/VBoxContainer/pick_stone_tutorial"]
anchor_left = 0.038835
anchor_top = 0.0833333
anchor_right = 0.932039
anchor_bottom = 0.916667
size_flags_horizontal = 0
theme = ExtResource( 12 )
text = "tutorial.pick_stone"
align = 1
valign = 1
autowrap = true
__meta__ = {
"_edit_use_anchors_": true
}

[node name="MarginContainer" type="MarginContainer" parent="HBoxContainer/VBoxContainer"]
margin_top = 133.0
margin_right = 100.0
margin_bottom = 135.0
custom_constants/margin_bottom = 2

[connection signal="timeout" from="tutorial_controller/movement_first_appear_timer" to="movement_joystick/h_box_container/movement_joystick/movement_tutorial" method="show"]
[connection signal="timeout" from="tutorial_controller/movement_timer" to="tutorial_controller" method="_on_movement_timer_timeout"]
[connection signal="timeout" from="tutorial_controller/hunger_timer" to="tutorial_controller" method="_on_hunger_timer_timeout"]
[connection signal="joystick_pressed" from="shooting_joystick/shooting_joystick_vertical_container/shooting_joystick/background/button_pivot/TouchScreenButton" to="shooting_joystick/shooting_joystick_vertical_container/shooting_joystick/pressed_method_caller" method="call_method"]
[connection signal="joystick_released" from="shooting_joystick/shooting_joystick_vertical_container/shooting_joystick/background/button_pivot/TouchScreenButton" to="shooting_joystick/shooting_joystick_vertical_container/shooting_joystick/released_method_caller" method="call_method"]
[connection signal="pressed" from="special_attack/special_attack_vertical_container/button_anchor/special_attack_button/TouchScreenButton" to="special_attack/special_attack_vertical_container/button_anchor/special_attack_button/TouchScreenButton/comp_method_caller" method="call_method"]
[connection signal="released" from="special_attack/special_attack_vertical_container/button_anchor/special_attack_button/TouchScreenButton" to="special_attack/special_attack_vertical_container/button_anchor/special_attack_button/TouchScreenButton/comp_method_caller" method="call_method"]
[connection signal="event_received" from="special_attack/special_attack_vertical_container/button_anchor/special_attack_button/grayscale_overlay/set_grayscale_event" to="special_attack/special_attack_vertical_container/button_anchor/special_attack_button/grayscale_overlay" method="hide"]
[connection signal="event_received" from="special_attack/special_attack_vertical_container/button_anchor/special_attack_button/grayscale_overlay/set_normal_event" to="special_attack/special_attack_vertical_container/button_anchor/special_attack_button/grayscale_overlay" method="show"]
[connection signal="joystick_pressed" from="movement_joystick/h_box_container/movement_joystick/background/button_pivot/TouchScreenButton" to="shooting_joystick/shooting_joystick_vertical_container/shooting_joystick/pressed_method_caller" method="call_method"]
[connection signal="pressed" from="pause_button/HBoxContainer/button_anchor/pause_button" to="pause_button/HBoxContainer/button_anchor/pause_button/comp_event_caller" method="call_event"]

[editable path="shooting_joystick/shooting_joystick_vertical_container/shooting_joystick"]
[editable path="movement_joystick/h_box_container/movement_joystick"]
[editable path="pause_button/HBoxContainer/button_anchor/pause_button"]
